{"version":3,"file":"login.js","sources":["../../../../resources/js/components/Login.vue","../../../../resources/js/tiers/admin/startup/Login.ts"],"sourcesContent":["<script setup lang=\"ts\">\nimport Button from \"@/modules/bootstrap/components/Button.vue\";\nimport StringInput from \"@/modules/form/components/StringInput.vue\";\nimport { createModel } from \"@/modules/form/hooks/model\";\nimport { Field } from \"@/modules/form/lib/field\";\nimport { Model } from \"@/modules/form/lib/model\";\nimport { RequiredRule } from \"@/modules/form/rules/required\";\nimport { StringRule } from \"@/modules/form/rules/string\";\nimport { mdiAccount, mdiFormTextboxPassword, mdiSend } from \"@mdi/js\";\nimport { onMounted, onUnmounted, ref } from \"vue\";\nimport Icon from \"@/components/Icon.vue\";\nimport { api } from \"@/lib/api\";\nimport { metadata } from \"@/lib/metadata\";\nimport { isDark } from \"@/modules/theme\";\n\ntype Props = {\n  redirectUrl?: string;\n};\n\nconst { redirectUrl = \"\" } = defineProps<Props>();\n\nclass Login extends Model {\n  get username(): Field {\n    return this.field(\"username\", \"Username\", this.initData?.username ?? \"\");\n  }\n\n  get password(): Field {\n    return this.field(\"password\", \"Password\", this.initData?.password ?? \"\");\n  }\n\n  get rules(): any[] {\n    return [\n      [[this.username, this.password], StringRule],\n      [[this.username, this.password], RequiredRule],\n    ];\n  }\n}\nconst button = ref<any>(null);\n\nconst [model, newModel, destroyModel] = createModel(Login);\n\nconst login = () => {\n  model.value?.validate()?.then((valid: boolean) => {\n    if (valid) {\n      button.value?.start?.();\n      api()\n        .post(\"/login\", model.value?.data ?? {})\n        .then(({ data }: any) => {\n          if (data.code === 200) {\n            const form = document.createElement(\"form\");\n            form.name = \"login\";\n            form.method = \"POST\";\n            form.action = `${metadata()?.url?.self}/Login`;\n            form.style.visibility = \"hidden\";\n            form.style.width = \"0px\";\n            form.style.height = \"0px\";\n            form.style.overflow = \"hidden\";\n            form.style.opacity = \"0\";\n\n            const tokenInput = document.createElement(\"input\");\n            tokenInput.type = \"hidden\";\n            tokenInput.name = \"token\";\n            tokenInput.value = data.token;\n            form.appendChild(tokenInput);\n\n            const expireInput = document.createElement(\"input\");\n            expireInput.type = \"hidden\";\n            expireInput.name = \"expire\";\n            expireInput.value = data.expire;\n            form.appendChild(expireInput);\n\n            const redirectUrlInput = document.createElement(\"input\");\n            redirectUrlInput.type = \"hidden\";\n            redirectUrlInput.name = \"redirectUrl\";\n            redirectUrlInput.value = redirectUrl ?? \"\";\n            form.appendChild(redirectUrlInput);\n\n            document.body.appendChild(form);\n            form.submit();\n          }\n        })\n        .catch((err) => {\n          model.value?.addRemoteErrors?.(err);\n        })\n        .finally(() => {\n          button.value?.stop?.();\n        });\n    }\n  });\n};\n\nonMounted(() => {\n  newModel();\n});\n\nonUnmounted(() => {\n  destroyModel();\n});\n</script>\n<template>\n  <form v-if=\"model\" @submit.prevent=\"login\" class=\"login-form\">\n    <div>\n      <StringInput :field=\"model.username\">\n        <template #before>\n          <Icon :path=\"mdiAccount\" :color=\"isDark() ? 'info' : 'primary'\" />\n        </template>\n      </StringInput>\n    </div>\n    <div>\n      <StringInput :field=\"model.password\" type=\"password\">\n        <template #before>\n          <Icon\n            :path=\"mdiFormTextboxPassword\"\n            :color=\"isDark() ? 'info' : 'primary'\"\n          />\n        </template>\n      </StringInput>\n    </div>\n    <div class=\"d-flex justify-content-center align-items-center\">\n      <Button\n        type=\"submit\"\n        color=\"primary\"\n        class=\"fw-bold w-100\"\n        spinner-color=\"light\"\n        ref=\"button\"\n      >\n        <Icon :path=\"mdiSend\" color=\"info\" />SIGN IN</Button\n      >\n    </div>\n  </form>\n</template>\n<style lang=\"scss\">\n@import \"@scss/config\";\n@import \"@scss/mixins/dark\";\n\n.login-form {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  gap: 30px;\n  width: 100%;\n  background: rgba($white, 0.6);\n  padding: 20px;\n  border-radius: 15px;\n  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16);\n  @include dark {\n    background: rgba($black, 0.6);\n  }\n  label {\n    color: $info;\n    font-weight: bold;\n  }\n  input {\n    height: 50px;\n  }\n  button {\n    height: 50px;\n  }\n}\n</style>\n","/**\n * Login.vue Startup File\n *\n * @project palacegroup1\n * @company Codendot <https://codendot.com>\n * @author Jawdat Sobh <jawdat@codendot.com>\n * @since Saturday, September 16, 2023 at 06:08 PM GMT+3\n *\n */\n\nimport { createApp } from \"@/lib/app\"\nimport AppComponent from \"../apps/Login.vue\"\nimport bootstrap from \"../bootstrap/Login\"\n\nconst app = createApp(\"login\", AppComponent)\nbootstrap(app)\napp.mount()\n"],"names":["Login","Model","_a","StringRule","RequiredRule","button","ref","model","newModel","destroyModel","createModel","login","_b","valid","api","_c","data","form","metadata","tokenInput","expireInput","redirectUrlInput","__props","err","onMounted","onUnmounted","app","createApp","AppComponent"],"mappings":"ioCAqBA,MAAMA,UAAcC,CAAM,CACxB,IAAI,UAAkB,OACpB,OAAO,KAAK,MAAM,WAAY,aAAYC,EAAA,KAAK,WAAL,YAAAA,EAAe,WAAY,EAAE,CACzE,CAEA,IAAI,UAAkB,OACpB,OAAO,KAAK,MAAM,WAAY,aAAYA,EAAA,KAAK,WAAL,YAAAA,EAAe,WAAY,EAAE,CACzE,CAEA,IAAI,OAAe,CACV,MAAA,CACL,CAAC,CAAC,KAAK,SAAU,KAAK,QAAQ,EAAGC,CAAU,EAC3C,CAAC,CAAC,KAAK,SAAU,KAAK,QAAQ,EAAGC,CAAY,CAAA,CAEjD,CACF,CACM,MAAAC,EAASC,EAAS,IAAI,EAEtB,CAACC,EAAOC,EAAUC,CAAY,EAAIC,EAAYV,CAAK,EAEnDW,EAAQ,IAAM,UAClBC,GAAAV,EAAAK,EAAM,QAAN,YAAAL,EAAa,aAAb,MAAAU,EAAyB,KAAMC,GAAmB,WAC5CA,KACFD,GAAAV,EAAAG,EAAO,QAAP,YAAAH,EAAc,QAAd,MAAAU,EAAA,KAAAV,GACAY,IACG,KAAK,WAAUC,EAAAR,EAAM,QAAN,YAAAQ,EAAa,OAAQ,CAAA,CAAE,EACtC,KAAK,CAAC,CAAE,KAAAC,KAAgB,SACnB,GAAAA,EAAK,OAAS,IAAK,CACf,MAAAC,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,KAAO,QACZA,EAAK,OAAS,OACdA,EAAK,OAAS,IAAGL,GAAAV,EAAAgB,EAAS,IAAT,YAAAhB,EAAY,MAAZ,YAAAU,EAAiB,IAAI,SACtCK,EAAK,MAAM,WAAa,SACxBA,EAAK,MAAM,MAAQ,MACnBA,EAAK,MAAM,OAAS,MACpBA,EAAK,MAAM,SAAW,SACtBA,EAAK,MAAM,QAAU,IAEf,MAAAE,EAAa,SAAS,cAAc,OAAO,EACjDA,EAAW,KAAO,SAClBA,EAAW,KAAO,QAClBA,EAAW,MAAQH,EAAK,MACxBC,EAAK,YAAYE,CAAU,EAErB,MAAAC,EAAc,SAAS,cAAc,OAAO,EAClDA,EAAY,KAAO,SACnBA,EAAY,KAAO,SACnBA,EAAY,MAAQJ,EAAK,OACzBC,EAAK,YAAYG,CAAW,EAEtB,MAAAC,EAAmB,SAAS,cAAc,OAAO,EACvDA,EAAiB,KAAO,SACxBA,EAAiB,KAAO,cACPA,EAAA,MAAQC,eAAe,GACxCL,EAAK,YAAYI,CAAgB,EAExB,SAAA,KAAK,YAAYJ,CAAI,EAC9BA,EAAK,OAAO,CACd,CAAA,CACD,EACA,MAAOM,GAAQ,UACRX,GAAAV,EAAAK,EAAA,QAAA,YAAAL,EAAO,kBAAP,MAAAU,EAAA,KAAAV,EAAyBqB,EAAG,CACnC,EACA,QAAQ,IAAM,UACbX,GAAAV,EAAAG,EAAO,QAAP,YAAAH,EAAc,OAAd,MAAAU,EAAA,KAAAV,EAAqB,CACtB,EACL,EACD,EAGH,OAAAsB,EAAU,IAAM,CACLhB,GAAA,CACV,EAEDiB,EAAY,IAAM,CACHhB,GAAA,CACd,6+BCnFKiB,GAAMC,EAAU,QAASC,EAAY,EAE3CF,GAAI,MAAM"}