var at=Object.defineProperty;var ot=(r,s,a)=>s in r?at(r,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[s]=a;var M=(r,s,a)=>(ot(r,typeof s!="symbol"?s+"":s,a),a);import{a as N,s as Q}from"./api.js";import{n as lt,a as nt,B as j}from"./Button.js";import{l as R}from"./index.js";import{d as W,c as P,a as h,f as C,r as it,z as ct,k as b,e as u,v as w,b as D,A as x,y as V,F as G,g as dt}from"./mc55b2a42316522d6.js";import{_ as X}from"./_plugin-vue_export-helper.js";import{c as ut,F as T,f as ft,C as pt,M as ht}from"./ModalForm.js";import{S as gt,M as yt}from"./StringInput.js";import{T as J}from"./TextInput.js";import{I as U}from"./Icon.js";import{m as bt,a as vt}from"./m6cd080c8112b9076.js";import{r as B,u as _}from"./m6bdda40d8bd2cf5a.js";import{K as A}from"./ma6cfd38af5d4c661.js";class _t{constructor(s){M(this,"_action",()=>{});M(this,"_events",{});this.count=s}set action(s){this._action=s}get action(){return this._action}on(s,a){this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(a)}dispatch(s,a=null){if(this._events.hasOwnProperty(s))for(const k of this._events[s])k(new CustomEvent(s,{bubbles:!0,detail:{target:this,data:a}}))}start(){this.dispatch("start"),Y(this)}}function Y(r,s=0){kt(r,s),r.count>s?r.action(s,()=>{Y(r,s+1)}):r.dispatch("done")}function kt(r,s){let a=Math.ceil(s*100/r.count);a>100&&(a=100),r.dispatch("progress",{current:s,total:r.count,percentage:a})}function mt(r){return new _t(r)}const St=W({__name:"Badge",props:{color:{default:"primary"},bgColor:{default:null},pill:{type:Boolean,default:!1}},setup(r){const s=P(()=>{const a={badge:!0};return r.bgColor?(a[`text-${r.color}`]=!0,a[`bg-${r.bgColor}`]=!0):a[`text-bg-${r.color}`]=!0,r.pill&&(a["rounded-pill"]=!0),a});return(a,k)=>(h(),C("span",ct({class:s.value},a.$attrs),[it(a.$slots,"default")],16))}}),F=X(St,[["__file","Badge.vue"]]),wt=["innerHTML"],xt={class:"d-flex flex-horizontal gap-2"},Tt={key:0,class:"d-flex flex-horizontal gap-2"},Ct=["innerHTML"],$t={class:"mb-3"},Dt={class:"mb-3"},Bt={class:"mb-3"},Et=W({__name:"Seo",props:{target:{}},setup(r){const s=ut({type:T.Number,name:"id",label:"ID",sortable:!0,searchable:!0,fitable:!0},{type:T.String,name:"title",label:"Title",sortable:!0,searchable:!0},{type:T.String,name:"description",label:"Description",sortable:!0,searchable:!0},{type:T.String,name:"keywords",label:"Keywords",sortable:!0,searchable:!0,fitable:!0},{type:T.String,name:"target",label:"Page",sortable:!0,searchable:!0,fitable:!0}),a=B(null),k=B(null),E=B(null),L=B(!1);class Z extends yt{get id(){var e;return this.field("id","ID",((e=this.initData)==null?void 0:e.id)??null)}get target(){var e;return this.field("target","Target",((e=this.initData)==null?void 0:e.target)??null)}get title(){var e;return this.field("title","Title",((e=this.initData)==null?void 0:e.title)??"")}get description(){var e;return this.field("description","Description",((e=this.initData)==null?void 0:e.description)??"")}get keywords(){var e;return this.field("keywords","Keywords",((e=this.initData)==null?void 0:e.keywords)??[],"Separate keywords by comma")}get rules(){return[]}}const H=l=>{L.value=l},q=()=>{var o,g,n,d,v;(g=(o=E.value)==null?void 0:o.start)==null||g.call(o);const l=(v=(d=(n=a.value)==null?void 0:n.data)==null?void 0:d.call(n))==null?void 0:v.map(i=>{var f;return(f=i.target)==null?void 0:f.split("-").at(1)}),e=R().filter(({value:i})=>!l.includes(i)),t=mt(e.length);t.action=(i,f)=>{var c,y;N().post("/seo",{target:`${r.target}${(y=(c=e==null?void 0:e.at)==null?void 0:c.call(e,i))==null?void 0:y.value}`,keywords:[],description:"",title:`Seo Title ${new Date().getTime()}`}).then(()=>{f()})},t.on("done",()=>{var i,f,c,y;Q("Seo Created Successfully"),(f=(i=a.value)==null?void 0:i.refresh)==null||f.call(i),(y=(c=E.value)==null?void 0:c.stop)==null||y.call(c)}),t.start()},tt=l=>{var t,o;const e={...l};e.keywords=e.keywords.join(`
`),(o=(t=k.value)==null?void 0:t.open)==null||o.call(t,e)},et=(l,e)=>{var o,g;const t=l.data;t.keywords=((g=(o=t.keywords)==null?void 0:o.split)==null?void 0:g.call(o,","))??[],N().put(`/seo/${t.id}`,t).finally(()=>{var n,d;Q("Seo Created Successfully"),(d=(n=a.value)==null?void 0:n.refresh)==null||d.call(n),e()}).catch(n=>{var d;e(!0),(d=l==null?void 0:l.addRemoteErrors)==null||d.call(l,n)})},st=P(()=>{if(r.target)return{filter:{target:{like:r.target}}}}),rt=P(()=>{var l,e,t;return((e=(l=a.value)==null?void 0:l.length)==null?void 0:e.call(l))<((t=R())==null?void 0:t.length)});return(l,e)=>(h(),C(G,null,[b(pt,{ref_key:"crud",ref:a,fields:_(s),fetch:_(ft)("/seo",void 0,st.value),onEmpty:e[0]||(e[0]=t=>H(!0)),onNoEmpty:e[1]||(e[1]=t=>H(!1))},{descriptionValue:u(({item:t})=>[w("div",{innerHTML:_(lt)((t==null?void 0:t.description)??"")},null,8,wt)]),targetValue:u(({item:t})=>{var o,g,n,d,v,i,f,c,y,z;return[w("div",xt,[(f=(i=(v=(d=(n=(g=(o=t==null?void 0:t.target)==null?void 0:o.split)==null?void 0:g.call(o,"-"))==null?void 0:n[0])==null?void 0:d.toString())==null?void 0:v.split)==null?void 0:i.call(v,":"))!=null&&f[0]?(h(),D(F,{key:0,color:"primary"},{default:u(()=>{var p,m,S,I,$,K,O;return[x(A(((O=(K=($=(I=(S=(m=(p=t==null?void 0:t.target)==null?void 0:p.split)==null?void 0:m.call(p,"-"))==null?void 0:S[0])==null?void 0:I.toString())==null?void 0:$.split)==null?void 0:K.call($,":"))==null?void 0:O[0])??""),1)]}),_:2},1024)):V("",!0),(z=(y=(c=t==null?void 0:t.target)==null?void 0:c.split)==null?void 0:y.call(c,"-"))!=null&&z[1]?(h(),D(F,{key:1,color:"info"},{default:u(()=>{var p,m,S;return[x(A(((S=(m=(p=t==null?void 0:t.target)==null?void 0:p.split)==null?void 0:m.call(p,"-"))==null?void 0:S[1])??""),1)]}),_:2},1024)):V("",!0)])]}),keywordsValue:u(({item:t})=>[Array.isArray(t.keywords)&&t.keywords.length>0?(h(),C("div",Tt,[(h(!0),C(G,null,dt(t.keywords,o=>(h(),D(F,{key:o,color:"warning"},{default:u(()=>[x(A(o),1)]),_:2},1024))),128))])):(h(),C("div",{key:1,innerHTML:_(nt)()},null,8,Ct))]),actions:u(({item:t})=>[b(j,{color:"info",class:"text-light",onClick:o=>tt(t)},{default:u(()=>[b(U,{path:_(bt),color:"light"},null,8,["path"]),x("Edit ")]),_:2},1032,["onClick"])]),topActions:u(()=>[l.target&&(L.value||rt.value)?(h(),D(j,{key:0,ref_key:"adder",ref:E,color:"primary",class:"text-light",onClick:q},{default:u(()=>[b(U,{path:_(vt),color:"light"},null,8,["path"]),x("Add Seo ")]),_:1},512)):V("",!0)]),_:1},8,["fields","fetch"]),b(ht,{ref_key:"modal",ref:k,name:"SEO","model-class":Z,onSave:et},{default:u(({model:t})=>[w("div",$t,[b(gt,{field:t.title},null,8,["field"])]),w("div",Dt,[b(J,{field:t.description,style:{height:"200px"}},null,8,["field"])]),w("div",Bt,[b(J,{field:t.keywords,style:{height:"200px"}},null,8,["field"])])]),_:1},512)],64))}}),jt=X(Et,[["__file","Seo.vue"]]);export{jt as S};
//# sourceMappingURL=Seo.js.map
