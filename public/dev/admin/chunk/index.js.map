{"version":3,"file":"index.js","sources":["../../../../resources/js/lib/metadata.ts","../../../../resources/js/lib/helper/cookies.ts","../../../../resources/js/modules/theme/index.ts"],"sourcesContent":["let _initData: any = null;\n\nexport type Url = {\n  api: string;\n  self: string;\n  base: {\n    absolute: string;\n    relative: string;\n  };\n};\n\nexport type Cms = {\n  type: { name: string; label: string }[];\n  category: any;\n  content: any;\n};\n\nexport type SettingsItem = {\n  type: string;\n  key?: string;\n  name: string;\n  label: string;\n  icon?: string;\n  defaultValue?: any;\n  attributes?: { [name: string]: any };\n  props?: { [name: string]: any };\n};\n\nexport type SettingsCategory = {\n  name: string;\n  label: string;\n  items: Array<SettingsItem>;\n};\n\nexport type Settings = Array<SettingsCategory>;\n\nexport type Language = {\n  value: string;\n  label: string;\n};\n\nexport type Metadata = {\n  env?: string;\n  id?: string;\n  name?: string;\n  language?: string;\n  languages?: Language[];\n  tier?: string;\n  token?: null | string;\n  user?: null | any;\n  isAuth?: boolean;\n  isGuest?: boolean;\n  route?: string;\n  translations?: { [msg: string]: string };\n  permissions?: any;\n  url?: Url;\n  isMobile?: boolean;\n  isTablet?: boolean;\n  isDesktop?: boolean;\n  cms?: Cms;\n  settings?: Settings;\n  balancesGroups?: string[][];\n  currenciesSort?: string[];\n  recaptchaSiteKey?: string;\n};\n\nfunction decodeData(): any {\n  if (!_initData) {\n    const z = Math.pow(2, 3) + 2;\n    const t = Math.pow(2, 1);\n    const m = z * t * 5 + Math.pow(10, 2);\n    const n = [78, 80, 101, 82, 102, 90, 91]\n      .map((x) => String.fromCharCode(m - x))\n      .join(\"\");\n    const d = window;\n    const q = d[n];\n    const res = JSON.parse(\n      window.atob(\n        q\n          .map((value: any, i: any) =>\n            i > 0 ? String.fromCharCode(q.slice(0, 1).shift() - value) : null\n          )\n          .filter((x: any) => x !== null)\n          .join(\"\")\n      )\n    );\n    _initData = res;\n  }\n  return _initData;\n}\n\nlet _meta: null | Metadata = null;\n\nexport function metadata(): null | Metadata {\n  if (!_meta) {\n    _meta = decodeData();\n  }\n  return _meta;\n}\n\nlet _translations: any = null;\n\nexport function translate(message: string, ...params: any): string {\n  if (!_translations) {\n    _translations = metadata()?.translations;\n  }\n  if (_translations) {\n    message = _translations?.[message] ?? message;\n\n    if (Array.isArray(params)) {\n      params.forEach((item) => {\n        message = message.replace(\":?\", item);\n      });\n    }\n  }\n  return message;\n}\n\nexport function user(): null | any {\n  return metadata()?.user ?? null;\n}\n\nexport function token(): null | string {\n  return metadata()?.token ?? null;\n}\n\nlet _permissions: any = null;\n\nexport function can(permission: any): boolean {\n  if ([\"developer\", \"master\"].includes(user()?.type)) {\n    return true;\n  }\n\n  if (!_permissions) {\n    _permissions = metadata()?.permissions;\n  }\n\n  let permitted = false;\n  if (_permissions) {\n    permission.split(\"|\").forEach((perm: string) => {\n      permitted = permitted || _permissions.hasOwnProperty(perm);\n    });\n  }\n  return permitted;\n}\n\nexport function language(): string {\n  return metadata()?.language ?? \"en\";\n}\n\nexport function languages(): Language[] {\n  return metadata()?.languages ?? [];\n}\n\nexport function cms(): Cms | null {\n  return metadata()?.cms ?? null;\n}\n\nexport function settings(): Settings | null {\n  return metadata()?.settings ?? null;\n}\n\nexport function route(): string {\n  return metadata()?.route ?? \"\";\n}\n","export function getCookie(name): any {\n  var v = document.cookie.match(\"(^|;) ?\" + name + \"=([^;]*)(;|$)\");\n  return v ? v[2] : null;\n}\n\nexport function setCookie(name, value, days): void {\n  var d = new Date();\n  d.setTime(d.getTime() + 24 * 60 * 60 * 1000 * days);\n  document.cookie = name + \"=\" + value + \";path=/;expires=\" + d.toString();\n}\n\nexport function deleteCookie(name): void {\n  setCookie(name, \"\", -1);\n}\n","import { setCookie } from \"@/lib/helper/cookies\";\nimport { metadata } from \"@/lib/metadata\";\nimport { defineStore } from \"pinia\";\nimport { computed, nextTick, ref } from \"vue\";\n\nexport const THEME_LIGHT = 0;\nexport const THEME_DARK = 1;\nexport const THEME_AUTO = 2;\n\nexport const themes = [\"light\", \"dark\", \"auto\"];\n\nexport const getStoredTheme = () =>\n  localStorage.getItem(`theme-${metadata?.()?.tier}`);\nexport const setStoredTheme = (theme) => {\n  localStorage.setItem(`theme-${metadata?.()?.tier}`, theme);\n};\n\nexport const getPreferredTheme = () => {\n  const storedTheme = getStoredTheme();\n  if (storedTheme) {\n    return storedTheme;\n  }\n\n  return window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n    ? \"dark\"\n    : \"light\";\n};\n\nexport const setTheme = (theme) => {\n  if (\n    theme === \"auto\" &&\n    window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n  ) {\n    document.documentElement.setAttribute(\"data-bs-theme\", \"dark\");\n    setCookie(`theme-${metadata?.()?.tier}`, \"dark\", 73200);\n  } else {\n    document.documentElement.setAttribute(\"data-bs-theme\", theme);\n    setCookie(`theme-${metadata?.()?.tier}`, theme, 73200);\n  }\n};\n\nexport const initTheme = () => {\n  setTheme(getPreferredTheme());\n};\n\nexport const useThemeStore = defineStore(\"theme\", () => {\n  const themeInc = ref<number>(\n    getPreferredTheme() === \"dark\"\n      ? THEME_DARK\n      : getPreferredTheme() === \"light\"\n      ? THEME_LIGHT\n      : THEME_AUTO\n  );\n\n  const theme = computed(() => {\n    return themes[themeInc.value % 3];\n  });\n\n  const isDarkTheme = computed(() => {\n    return (\n      theme.value === \"dark\" ||\n      (window.matchMedia(\"(prefers-color-scheme: dark)\").matches &&\n        theme.value === \"auto\")\n    );\n  });\n\n  const changeTheme = () => {\n    themeInc.value++;\n    nextTick(() => {\n      setStoredTheme(theme.value);\n      setTheme(theme.value);\n    });\n  };\n  return { theme, isDarkTheme, changeTheme };\n});\n\nexport function isDark() {\n  const themeStore = useThemeStore();\n  return themeStore.isDarkTheme;\n}\n\nexport function theme() {\n  const themeStore = useThemeStore();\n  return themeStore.theme;\n}\n\nwindow\n  .matchMedia(\"(prefers-color-scheme: dark)\")\n  .addEventListener(\"change\", () => {\n    const storedTheme = getStoredTheme();\n    if (storedTheme !== \"light\" && storedTheme !== \"dark\") {\n      setTheme(getPreferredTheme());\n    }\n  });\n"],"names":["_initData","decodeData","z","m","n","x","q","value","i","_meta","metadata","_translations","translate","message","params","_a","item","user","language","languages","cms","settings","setCookie","name","days","d","THEME_LIGHT","THEME_DARK","THEME_AUTO","themes","getStoredTheme","setStoredTheme","theme","getPreferredTheme","storedTheme","setTheme","_b","initTheme","useThemeStore","defineStore","themeInc","ref","computed","isDarkTheme","nextTick","isDark"],"mappings":"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"}